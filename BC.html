<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<html>
<head>
<meta charset="utf-8">
<title>HPC | CNRS, TOURS, France</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="Nasir CV" name="description">
<meta name="keywords" content="Nasir Mahmood Abbasi, Research Engineer Bioinformatics">
<meta name="author" content="Nasir">
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
    <meta name="description" content="HPC">

    <!-- Bootstrap -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="static/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
    <link href="static/css/core.css" rel="stylesheet" media="screen">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->

    <link rel="icon" href="static/img/favicon.ico">






    <script type="text/javascript" src="Nasir_CV/js/openInNewWindow.js"></script>
    <script type="text/javascript" src="Nasir_CV/js/toggle.js"></script>
   <style media="all" type="text/css">



   <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
   <!--[if lt IE 9]>
     <script src="js/html5shiv.js"></script>
   <![endif]-->

   <link rel="icon" href="static/img/favicon.ico"> -->


   @import url(main.css);
    .Estilo1 {
	color: #0000FF;
	font-weight: bold;
	font-style: italic;
}
   .Estilo2 {font-style: italic; color: #0000FF;}
   </style>

   <!--[if IE]>
<style>
#right {
        margin-left: 15px;
  }
  </style>
      <![endif]-->

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28510826-1', 'auto');
  ga('send', 'pageview');




</script>
</head>

<body>
  <div class="container">

    <div class="masthead">

<!-- NAVBAR
  ================================================== -->
          <div class="navbar-wrapper">
    <!-- Wrap the .navbar in .container to center it within the absolutely positioned parent. -->
    <div class="container">
      <div class="navbar navbar-inverse">



        <div class="navbar-inner pull-center">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>

          <div class="nav-collapse collapse">

            <ul class="nav nav-tabs navbar-nav  ">
              <li ><a href="index.html"><b>HOME</b></a></li>


              <li role="presentation" class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" id="drop1" href="#" role="button" aria-haspopup="true" aria-expanded="false"> <b> High Performance Computing (HPC)</b> <b span class="caret"></span></a></b>

                    <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                        <li role="presentation"> <a role="menuitem" tabindex="-1" href="connections.html">Connection</a></li>
                        <li role="presentation"> <a role="menuitem" tabindex="-1"href="BC.html">Basic commands</a></li>
                        <li role="presentation"> <a role="menuitem" tabindex="-1" href="ss.html">Submission Scripts</a></li>
                        <li role="presentation"> <a role="menuitem" tabindex="-1"href="CM.html">Custom Module</a></li>
                        <li role="presentation"> <a role="menuitem" tabindex="-1" href="conda.html">Conda on a Cluster</a></li>

                    </ul>
                  </li>
          <!--    <li><a href="index.html">Other Research Computing</a></li> -->
          <!--     <li><a href="index.html">Recommendations</a></li> -->
        <!--      <li><a href="index.html">Nasir Activities</a></li> -->
<li> <a href="support.html"><b>Support</b></a></li>
              <li> <a href="QR.html"><b>Question/Requests</b></a></li>


            </ul>
          </div>
        </div>
      </div><!-- /.navbar -->
    </div>
    </div> <!-- /.container -->
  </div><!-- /.navbar-wrapper -->

    <html style="margin-top:20">
    	<head>
    		<title>
    			nmabbasi
    		</title>
    	</head>


    <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
    <head>
      <meta charset="utf-8" />
      <meta name="generator" content="pandoc" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
      <title>HOWTO</title>
      <style type="text/css">
          code{white-space: pre-wrap;}
          span.smallcaps{font-variant: small-caps;}
          span.underline{text-decoration: underline;}
          div.column{display: inline-block; vertical-align: top; width: 50%;}
      </style>
    </head>
    <body>

  <h1 id="basic-commands"><span class="header-section-number"></span> Basic commands</h1>
  <br><hr><br>
    <h2 id="modules"><span class="header-section-number"></span> Modules</h2>
    <p>Some programs are only available through modules: you need to load modules to use them. As an example, if you want to compile MPI programs with <em>mpic++</em>, you’ll have to load the correct module:</p>
    <pre><code>module load mpi/openmpi-x86_64</code></pre>
    <p>As always,</p>
    <pre><code>man module</code></pre>
    <p>will give you all possible options/commands. Here are the most important.</p>
    <pre><code>module avail</code></pre>
    <p>lists all available modules.</p>
    <p></p>
    <img src="MA.png" alt="MobXterm" width="1500" height="1500">
    <p></p>
    <pre><code>module list</code></pre>
    <p>lists all loaded modules.</p>
    <pre><code>module load X
    module unload X</code></pre>
    <p>loads and unloads modules.</p>
    <pre><code>module purge</code></pre>
    <p>unloads all modules.</p>
    <p>Don’t forget to load the appropriate modules inside submission scripts (see <a href="#writing-a-submission-script">Writing a submission script</a>). These inside-script module loads are usually preceded by <em>module purge</em>.</p>
    <h2 id="listing-partitions-and-nodes"><span class="header-section-number"></span> Listing partitions and nodes</h2>
    <pre><code>sinfo</code></pre>
    <p>The <em>STATE</em> column gives the states of the nodes given in the <em>NODELIST</em> column and may take (among others) the following values:</p>
    <ul>
    <li>idle: no resource allocated,</li>
    <li>mix: some resources allocated, but no resource fully allocated,</li>
    <li>alloc: at least one resource (number of CPUs or memory) fully allocated,</li>
    <li>drain: will finish the jobs currently running but will not accept any more jobs,</li>
    <li>down: node is shutdown.</li>
    <p></p>
    <img src="partitions.png" alt="MobXterm" width="1500" height="1500">
    <p></p>

    </ul>
    <p>All the possible states and a thousand options can be listed with:</p>
    <pre><code>man sinfo</code></pre>
    <p>Also, the following command will display the characteristics of each node:</p>
    <pre><code>sinfo --long --Node</code></pre>
    <p>The option <em>-p</em> allows restricting to the nodes of a single partition. The important columns of the output are <em>CPUS</em>, which gives the maximum number of CPUs that can be allocated, and <em>Memory</em>, which gives the maximum available memory in Megabytes.</p>
    <h2 id="listing-submitted-jobs"><span class="header-section-number"></span> Listing submitted jobs</h2>
    <pre><code>squeue</code></pre>
    <p>If you want to see only yours:</p>
    <pre><code>squeue -u `whoami`</code></pre>
    <p>The <em>ST</em> column is for the state of the job. You’ll usually see either <em>R</em> for running or <em>PD</em> for pending.</p>
    <h2 id="partitions-nodes-and-jobs-in-a-gui"><span class="header-section-number"></span> Partitions, nodes and jobs in a GUI</h2>
    <p>If X is activated (see section <a href="#running-a-gui">Running a GUI</a>), one can also run:</p>
    <pre><code>sview&amp;</code></pre>
    <h2 id="running-tasks"><span class="header-section-number"></span> Running tasks</h2>
    <p>There are two ways to run tasks on nodes: submit a job (section <a href="#submitting-a-job">Submitting a job</a>) or start an interactive session (section <a href="#running-an-interactive-session">Running an interactive session</a>). Interactive sessions should only be used in two cases:</p>
    <ul>
    <li>you want to run a GUI,</li>
    <li>you want to debug your program.</li>
    </ul>
    <p>In all other cases, it is better to submit a job script. The reason is that you need to allocate resources when starting an interactive session. By nature, there is usually downtime in interactive sessions (modifying scripts/programs, or not realising that the task has completed and letting it idle), and during this downtime, the resources you allocated and are currently not using are also unavailable to the other cluster users.</p>
    <p>If you struggle with the script, send an email to <em>yann.jullian<span style="display:none">foo</span><span class="citation" data-cites="univ-tours.fr">@univ-tours.fr</span></em> and use an interactive session in the meantime.</p>
    <h2 id="running-an-interactive-session"><span class="header-section-number"></span> Running an interactive session</h2>
    <p>You can only <em>ssh</em> directly onto a node if you have one job active on it. However, a similar result can be obtained by running:</p>
    <pre><code>srun --partition=ibrain --ntasks=1 --cpus-per-task=12 --mem=12G --pty /bin/bash -l</code></pre>
    <p>The options you can give there are mostly the same as the <em>sbatch</em> option (see <a href="#writing-a-submission-script">Writing a submission script</a>), and they specify resource allocation. The <em>--pty /bin/bash -l</em> part tells slurm to open a console. From there, you can execute the programs you want.</p>
    <p>As long as the console is open (type <em>exit</em> to leave), the resources will be allocated.</p>
    <p>As this is a long command, you may want to use an alias. Open your <em>~/.bashrc</em> and add a line:</p>
    <pre><code>alias interactive=&#39;srun --partition=ibrain --ntasks=1 --cpus-per-task=1 --mem=1G --pty /bin/bash -l&#39;</code></pre>
    <p>After relogging or running</p>
    <pre><code>source ~/.bashrc</code></pre>
    <p>you’ll be able to simply type <em>interactive</em> to start an interactive session.</p>
    <h2 id="running-a-gui"><span class="header-section-number"></span> Running a GUI</h2>
    <h3 id="if-you-connect-with-nx"><span class="header-section-number"></span> If you connect with NX</h3>
    <p>Nothing more to do.</p>
    <h3 id="if-you-connect-with-ssh"><span class="header-section-number"></span> If you connect with SSH</h3>
    <h4 id="linux-mac-1"><span class="header-section-number"></span> Linux / mac</h4>
    <p>Either give the <em>-X</em> option to the <em>ssh</em> command:</p>
    <pre><code>ssh -X esmeralda</code></pre>
    <p>or add <em>ForwardX11 yes</em> in your <em>~/.ssh/config</em> :</p>
    <pre><code>Host esmeralda
        Hostname 10.195.17.215
        User LOGIN
        ForwardX11 yes
        IdentityFile ~/.ssh/esmeralda</code></pre>
    <h4 id="mac"><span class="header-section-number"></span> Mac</h4>
    <p>Install <em>Xquartz</em>.</p>
    <h4 id="windows-1"><span class="header-section-number"></span> Windows</h4>
    <p>Nothing more to do.</p>
    <h3 id="in-all-cases"><span class="header-section-number"></span> In all cases</h3>
    <p>Give the <em>--x11</em> option to <em>srun</em>.</p>
    <pre><code>srun --x11 --partition=biopatic --nodelist=biopatic-node01 --ntasks=1 --pty rstudio</code></pre>
    <p>Or in two steps:</p>
    <pre><code>srun --x11 --partition=biopatic --nodelist=biopatic-node01 --ntasks=1 --pty /bin/bash -l</code></pre>
    <p>then</p>
    <pre><code>rstudio</code></pre>
    <h2 id="submitting-a-job"><span class="header-section-number"></span> Submitting a job</h2>
    <p>Write a submission script <em>launch.job</em> (see <a href="#writing-a-submission-script">Writing a submission script</a>), then run:</p>
    <pre><code>sbatch launch.job</code></pre>
    <h2 id="stopping-a-job"><span class="header-section-number"></span> Stopping a job</h2>
    <p>Get the ID number <em>N</em> of the job with the <em>squeue</em> command (<em>JOBID</em> column), then run:</p>
    <pre><code>scancel N</code></pre>



    		<br><hr><br>
    	</body>
    </html>




    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/bootstrap-dropdown.js"></script>
    <script>
      !function ($) {
        $(function(){
          // carousel demo
          $('#myCarousel').carousel()
        })
      }(window.jQuery)
    </script>
    <script>
    $(document).ready(function() {
        $('#drop1').dropdown();
    });
    </script>

  </body>
  </html>
