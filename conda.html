<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<html>
<head>
<meta charset="utf-8">
<title>HPC | CNRS, TOURS, France</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="Nasir CV" name="description">
<meta name="keywords" content="Nasir Mahmood Abbasi, Research Engineer Bioinformatics">
<meta name="author" content="Nasir">
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
    <meta name="description" content="HPC">

    <!-- Bootstrap -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="static/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
    <link href="static/css/core.css" rel="stylesheet" media="screen">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->

    <link rel="icon" href="static/img/favicon.ico">






    <script type="text/javascript" src="Nasir_CV/js/openInNewWindow.js"></script>
    <script type="text/javascript" src="Nasir_CV/js/toggle.js"></script>
   <style media="all" type="text/css">



   <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
   <!--[if lt IE 9]>
     <script src="js/html5shiv.js"></script>
   <![endif]-->

   <link rel="icon" href="static/img/favicon.ico"> -->


   @import url(main.css);
    .Estilo1 {
	color: #0000FF;
	font-weight: bold;
	font-style: italic;
}
   .Estilo2 {font-style: italic; color: #0000FF;}
   </style>

   <!--[if IE]>
<style>
#right {
        margin-left: 15px;
  }
  </style>
      <![endif]-->

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-28510826-1', 'auto');
  ga('send', 'pageview');




</script>
</head>

  <body>
    <div class="container">

      <div class="masthead">

<!-- NAVBAR
    ================================================== -->
            <div class="navbar-wrapper">
      <!-- Wrap the .navbar in .container to center it within the absolutely positioned parent. -->
      <div class="container">
        <div class="navbar navbar-inverse">
          <div class="navbar-inner pull-center">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <div class="nav-collapse collapse">
              <ul class="nav nav-tabs navbar-nav  ">
                <li ><a href="index.html"><b>HOME</b></a></li>


                <li role="presentation" class="dropdown">
                      <a class="dropdown-toggle" data-toggle="dropdown" id="drop1" href="#" role="button" aria-haspopup="true" aria-expanded="false"> <b> High Performance Computing (HPC)</b> <b span class="caret"></span></a></b>

                      <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
                          <li role="presentation"> <a role="menuitem" tabindex="-1" href="connections.html">Connection</a></li>
                          <li role="presentation"> <a role="menuitem" tabindex="-1"href="BC.html">Basic commands</a></li>
                          <li role="presentation"> <a role="menuitem" tabindex="-1" href="ss.html">Submission Scripts</a></li>
                          <li role="presentation"> <a role="menuitem" tabindex="-1"href="CM.html">Custom Module</a></li>
                          <li role="presentation"> <a role="menuitem" tabindex="-1" href="conda.html">Conda on a Cluster</a></li>

                      </ul>
                    </li>
            <!--    <li><a href="index.html">Other Research Computing</a></li> -->
            <!--     <li><a href="index.html">Recommendations</a></li> -->
          <!--      <li><a href="index.html">Nasir Activities</a></li> -->
<li> <a href="support.html"><b>Support</b></a></li>
                <li class="active"> <a href="QR.html"><b>Question/Requests</b></a></li>



              </ul>
            </div>
          </div>
        </div><!-- /.navbar -->
      </div>
      </div> <!-- /.container -->
    </div><!-- /.navbar-wrapper -->

    <html style="margin-top:20">
    	<head>
    		<title>
    			nmabbasi
    		</title>
    	</head>


    <!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
    <head>
      <meta charset="utf-8" />
      <meta name="generator" content="pandoc" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
      <title>HOWTO</title>
      <style type="text/css">
          code{white-space: pre-wrap;}
          span.smallcaps{font-variant: small-caps;}
          span.underline{text-decoration: underline;}
          div.column{display: inline-block; vertical-align: top; width: 50%;}
      </style>
    </head>
    <body>

      <div data-target="readme-toc.content" class="Box-body px-5 pb-5">
               <article class="markdown-body entry-content container-lg" itemprop="text"><h1 dir="auto"><a id="user-content-conda-on-the-cluster" class="anchor" aria-hidden="true" href="#conda-on-the-cluster"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conda on the Cluster</h1>
<br><hr><br>
   <h2 dir="auto"><a id="user-content-goals" class="anchor" aria-hidden="true" href="#goals"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Goals</h2>
   <ul dir="auto">
   <li>Understand what Conda is and how it can simplify analysis pipelines.</li>
   <li>Learn how to install and configure Conda on any system.</li>
   <li>Be able to create reproducible computing environments for (almost) any task.</li>
   </ul>
   <br>
   <h2 dir="auto"><a id="user-content-conda-in-theory" class="anchor" aria-hidden="true" href="#conda-in-theory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conda in Theory</h2>
   <h3 dir="auto"><a id="user-content-what-is-conda" class="anchor" aria-hidden="true" href="#what-is-conda"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What is Conda?</h3>
   <p dir="auto"><a href="https://docs.conda.io/projects/conda/en/latest/index.html" rel="nofollow"><strong>Conda</strong></a> is a Python-based environment and package manager. It helps produce reproducible analysis pipelines using crowd-sourced and version-controlled packages.</p>
   <br>
   <p dir="auto">If you are new to this type of approach, you may not know what that means. Here is some quick vocabulary so we're all on the same page:</p>
   <ul dir="auto">
   <li><strong>Environment</strong>: A computing environment is the collection of programs, language libraries, etc. in which a computer operates. Environments can be defined at many different levels similar to the ecological sense where an environment may refer to a 1 cm x 1 cm square of grass or an entire continent.</li>
   <li><strong>Package</strong>: A package is a collection of software that may contain things such as programs (e.g. Python), programming libraries (e.g. Perl), or other useful tools. Conda combines packages to construct environments for doing complex tasks.</li>
   </ul>
   <br>
   <p dir="auto">In short, what that means is Conda creates self-contained modules that contain all of the necessary programs, etc. for completing a particular computing task.</p>
   <br>
   <h3 dir="auto"><a id="user-content-why-is-conda-useful" class="anchor" aria-hidden="true" href="#why-is-conda-useful"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Why is Conda useful?</h3>
   <p dir="auto">Using Conda as part of analysis workflows has a lot of advantages:</p>
   <ul dir="auto">
   <li>It works on all major operating systems (Mac, Windows, and Linux).
   <blockquote>
   <p dir="auto"><strong>NOTE:</strong> While Conda works on all operating systems, not all packages are available for every operating system. Windows tends to be the most affected by this.</p>
   </blockquote>
   </li>
   <li>It helps keep your computing environment organized so you're less likely to end up in <a href="https://en.wikipedia.org/wiki/Dependency_hell" rel="nofollow"><strong>"dependency hell"</strong></a>.</li>
   <li>Packages are version-controlled so you can easily switch versions if one isn't working.</li>
   <li>Environments can be reproducible and shareable leading to increased analytical veracity.</li>
   <li>It works exceptionally well when combined the workflow managers. </li>
   </ul>
   <br>
   <h2 dir="auto"><a id="user-content-conda-in-practice" class="anchor" aria-hidden="true" href="#conda-in-practice"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conda in Practice</h2>
   <h3 dir="auto"><a id="user-content-installing-conda" class="anchor" aria-hidden="true" href="#installing-conda"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing Conda</h3>
   <p dir="auto">The process for installing Conda is the same across most operating systems but we will use the University of Tours HPC cluster as a uniform Linux environment for the purposes of this tutorial.</p>
   <blockquote>
   <p dir="auto"><strong>NOTE:</strong> If you don't have access to the cluster, skip to Step 3. Then, make sure to choose the correct installer and adjust accordingly going forward.</p>
   </blockquote>
   <br>
   <p dir="auto"><strong>1.</strong> Log into the University of Tours cluster.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="ssh UNIQNAME@greatlakes.arc-ts.umich.edu"><pre class="notranslate"><code>ssh UNIQNAME@ssh abbasi@10.195.17.215
   </code></pre></div>
   <br>
   <p dir="auto"><strong>2.</strong> You should be in your home folder but let's check to make sure.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="pwd"><pre class="notranslate"><code>pwd
   </code></pre></div>
   <br>
   <p dir="auto"><strong>3.</strong> To install Conda, we first need to find the proper installer on the <a href="https://docs.conda.io/en/latest/miniconda.html" rel="nofollow"><strong>website</strong></a>. We will be installing Miniconda instead of Anaconda since it only contains the essentials and tends to run faster. Right-click and copy the link address for the Miniconda Linux 64-bit installer that uses Python 3.7.</p>
   <p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/um-dang/conda_on_the_cluster/blob/master/images/miniconda_installer.png"><img src="miniconda_installer.png" alt="Image of Miniconda Linux installers" style="max-width: 100%;"></a></p>
   <br>
   <p dir="auto"><strong>4.</strong> Return to your terminal and use <code>wget</code> to download the installation script to your home folder on the cluster.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh"><pre class="notranslate"><code>wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
   </code></pre></div>
   <br>
   <p dir="auto"><strong>5.</strong> Verify the installation script is now in your home folder.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="ls"><pre class="notranslate"><code>ls
   </code></pre></div>
   <br>
   <p dir="auto"><strong>6.</strong> It's good practice to make sure downloaded files weren't corrupted during the download process. One way to do that is using <a href="https://en.wikipedia.org/wiki/Checksum" rel="nofollow"><strong>checksum hashes</strong></a> which are unique signatures generated based on the file contents. Some (but not all) sites will make the hash available so you can verify the download was successful. If your hash doesn't match the host's hash, it means there was an error with your download and you should probably try it again. The larger the files (e.g. large DNA sequencing files), the more important it is to check. Let's check ours now.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="shasum -a 256 Miniconda3-latest-Linux-x86_64.sh"><pre class="notranslate"><code>shasum -a 256 Miniconda3-latest-Linux-x86_64.sh
   </code></pre></div>
   <br>
   <p dir="auto"><strong>7.</strong> Compare the hash to the hash listed next to the installer. If it doesn't match (ours does so no problems), try downloading again or check your internet settings.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="8a324adcc9eaf1c09e22a992bb6234d91a94146840ee6b11c114ecadafc68121  Miniconda3-latest-Linux-x86_64.sh"><pre class="notranslate"><code>8a324adcc9eaf1c09e22a992bb6234d91a94146840ee6b11c114ecadafc68121  Miniconda3-latest-Linux-x86_64.sh
   </code></pre></div>
   <br>
   <p dir="auto"><strong>8.</strong> To install Miniconda, we need to run the script we just downloaded.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="bash Miniconda3-latest-Linux-x86_64.sh"><pre class="notranslate"><code>bash Miniconda3-latest-Linux-x86_64.sh
   </code></pre></div>
   <br>
   <p dir="auto"><strong>9.</strong> Follow the prompts on the screen to install the program to your home folder. When it asks whether you want to initialize Miniconda3, say <code>yes</code>. The process should only take a few minutes.</p>
   <br>
   <p dir="auto"><strong>10.</strong> When initializing, the installer will add a code chunk to the bottom of your <code>~/.bashrc</code> file. This file is used for customizing your terminal and environment. When the chunk is added to this file, it sets up your environment for using Conda though it does so based on which shell you are currently using. This is normally a good thing but can cause problems when submitting jobs to the cluster because the cluster's shell configuration is slightly different than the one we interact with. If we don't alter the code at the bottom of the <code>~/.bashrc</code>, our environment won't be passed to the cluster nodes properly and our jobs will fail. To fix this, we need to comment out most of the lines.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="nano ~/.bashrc"><pre class="notranslate"><code>nano ~/.bashrc
   </code></pre></div>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="# # &gt;&gt;&gt; conda initialize &gt;&gt;&gt;
   # # !! Contents within this block are managed by 'conda init' !!
   # __conda_setup=&quot;$('/home/wlclose/miniconda3/bin/conda' 'shell.bash' 'hook' 2&gt; /dev/null)&quot;
   # if [ $? -eq 0 ]; then
   #     eval &quot;$__conda_setup&quot;
   # else
       if [ -f &quot;/home/wlclose/miniconda3/etc/profile.d/conda.sh&quot; ]; then
           . &quot;/home/wlclose/miniconda3/etc/profile.d/conda.sh&quot;
       else
           export PATH=&quot;/home/wlclose/miniconda3/bin:$PATH&quot;
       fi
   # fi
   # unset __conda_setup
   # # &lt;&lt;&lt; conda initialize &lt;&lt;&lt;"><pre class="notranslate"><code># # &gt;&gt;&gt; conda initialize &gt;&gt;&gt;
   # # !! Contents within this block are managed by 'conda init' !!
   # __conda_setup="$('/home/wlclose/miniconda3/bin/conda' 'shell.bash' 'hook' 2&gt; /dev/null)"
   # if [ $? -eq 0 ]; then
   #     eval "$__conda_setup"
   # else
       if [ -f "/home/wlclose/miniconda3/etc/profile.d/conda.sh" ]; then
           . "/home/wlclose/miniconda3/etc/profile.d/conda.sh"
       else
           export PATH="/home/wlclose/miniconda3/bin:$PATH"
       fi
   # fi
   # unset __conda_setup
   # # &lt;&lt;&lt; conda initialize &lt;&lt;&lt;
   </code></pre></div>
   <br>
   <p dir="auto"><strong>11.</strong> Now that we've installed Conda and tweaked our <code>~/.bashrc</code>, we need to reload the shell session for our changes to take place. When we source <code>~/.bash_profile</code>, it should also source <code>~/.bashrc</code>. Alternatively, you can restart your terminal or terminal session.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="source ~/.bash_profile"><pre class="notranslate"><code>source ~/.bash_profile
   </code></pre></div>
   <br>
   <p dir="auto"><strong>12.</strong> Let's do a quick check to make sure we can now access the <code>conda</code> command.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda --help"><pre class="notranslate"><code>conda --help
   </code></pre></div>
   <p dir="auto">Looks great!</p>
   <br>
   <p dir="auto"><strong>13.</strong> For our last step, we can also create a <code>~/.condarc</code> file for <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/configuration/use-condarc.html" rel="nofollow">configuring Conda</a> similar to how we use our <code>~/.bashrc</code> to configure our shell, . We can use this to tell Conda where and how to search for packages that we want to download. With Conda, packages are retreived from version-controlled repositories called <strong>channels</strong> and different channels will have different themes. For example, the main bioinformatics channel is called <a href="https://bioconda.github.io/index.html" rel="nofollow"><strong>Bioconda</strong></a>.</p>
   <br>
   <p dir="auto">Conda comes with a few default channels included but they aren't always that useful. To fix this, we can add new channels to our <code>~/.condarc</code> file. Today, we'll be adding the <a href="https://conda-forge.org/" rel="nofollow"><strong>Conda-Forge</strong></a> channel. Packages on Conda-Forge are typically more up-to-date than the default channels and adding it will help satisfy a lot of potential dependency issues.</p>
   <br>
   <p dir="auto">To add Conda-Forge to your channels, type the following. If your <code>~/.condarc</code> doesn't already exist, this will also create it.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda config --add channels conda-forge"><pre class="notranslate"><code>conda config --add channels conda-forge
   </code></pre></div>
   <br>
   <p dir="auto">For the last configuration (and for more complex reasons) we should also change how priority is set when searching for packages. You can read more about it <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-channels.html#strict-channel-priority" rel="nofollow">here</a>.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda config --set channel_priority strict"><pre class="notranslate"><code>conda config --set channel_priority strict
   </code></pre></div>
   <br>
   <p dir="auto">With all that out of the way, Conda is now ready to use!</p>
   <br>
   <h2 dir="auto"><a id="user-content-creating-and-managing-environments" class="anchor" aria-hidden="true" href="#creating-and-managing-environments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Creating and Managing Environments</h2>
   <h3 dir="auto"><a id="user-content-environments-101" class="anchor" aria-hidden="true" href="#environments-101"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Environments 101</h3>
   <p dir="auto">Now that we've installed Conda, we're ready to start learning how to use it as an environment-based package manager. Environments are an integral part of Conda-based workflows. They are customizable, reproducible, and shareable modules that contain the resources for a specific task or set of tasks. Environments also help avoid "dependency hell" where required programs are incompatible with previously installed programs or program versions.</p>
   <br>
   <p dir="auto"><strong>1.</strong> To start with, let's see what environments we currently have set up. This will list all of the environments available for us to use along with their locations.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda env list"><pre class="notranslate"><code>conda env list
   </code></pre></div>
   <p dir="auto">By default, an environment called <code>base</code> is created when installing and intializing Conda. <code>base</code> contains a number of standard Python packages that may or may not be useful.</p>
   <br>
   <p dir="auto"><strong>2.</strong> Because we altered the code in our <code>~/.bashrc</code>, the <code>base</code> environment isn't loaded automatically when we log into the shell. This can help speed up tasks if you don't need to use anything in the environment but, if we do need to use something in the environment, we'll need to activate the environment first. We'll start with the <code>base</code> environment.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda activate base"><pre class="notranslate"><code>conda activate base
   </code></pre></div>
   <br>
   <p dir="auto"><strong>3.</strong> You should now see that the word <code>base</code> is in your prompt showing that we've loaded the base environment. Another way to check which environment you have active is to look at the <code>$CONDA_PREFIX</code> shell variable. If you don't have any environment loaded, the output will be blank.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="echo $CONDA_PREFIX"><pre class="notranslate"><code>echo $CONDA_PREFIX
   </code></pre></div>
   <br>
   <p dir="auto"><strong>4.</strong> Now that we have the <code>base</code> environment loaded, let's see which programs it contains for us to use.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda list"><pre class="notranslate"><code>conda list
   </code></pre></div>
   <p dir="auto">The output from this command lists all of the programs, their versions, the build number, and the channel they came from if outside of the <code>defaults</code> channels.</p>
   <br>
   <p dir="auto"><strong>5.</strong> We can check to make sure we are using the programs from our environment by using <code>which</code> to print the executable path or by checking our shell <code>$PATH</code> variable. The <code>$PATH</code> variable lists the order of folders from first to last that the shell will look through to find executables. The shell will execute the first binary it finds and ignore the rest so it's important our <code>$PATH</code> is in the correct order.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="which python
   echo $PATH"><pre class="notranslate"><code>which python
   echo $PATH
   </code></pre></div>
   <br>
   <h3 dir="auto"><a id="user-content-creating-task-specific-environments" class="anchor" aria-hidden="true" href="#creating-task-specific-environments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Creating Task-Specific Environments</h3>
   <p dir="auto">In a typical workflow, it's good practice to create environments for each task or script being executed to keep the environment running as fast as possible, reduce the likelihood of conflicting programs/versions, and assist in debugging when things don't work out. Let's create a new environment for analyzing 16S bacterial sequencing data with <a href="https://mothur.org/wiki/Main_Page" rel="nofollow"><strong>mothur</strong></a>.</p>
   <p dir="auto"><strong>1.</strong> First, let's deactivate the current environment.</p>
   <blockquote>
   <p dir="auto"><strong>NOTE:</strong> Deactivating the current environment is being done here for the sake of clarity. The process of creating and managing a new environment are exactly the same whether another environment is active or not.</p>
   </blockquote>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda deactivate"><pre class="notranslate"><code>conda deactivate
   </code></pre></div>
   <br>
   <p dir="auto"><strong>2.</strong> Next, let's create an empty environment for our <code>mothur</code> analysis.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda create -n mothur"><pre class="notranslate"><code>conda create -n mothur
   </code></pre></div>
   <br>
   <p dir="auto"><strong>3.</strong> We should see it in our list of available environments now. Also note that the new environment is created in the <code>miniconda3/envs/</code> subdirectory in our home folder. This is where binaries, etc. will be downloaded to if you ever need to find them.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda env list"><pre class="notranslate"><code>conda env list
   </code></pre></div>
   <br>
   <p dir="auto"><strong>4.</strong> Let's activate the new environment.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda activate mothur"><pre class="notranslate"><code>conda activate mothur
   </code></pre></div>
   <br>
   <p dir="auto"><strong>5.</strong> If we look at which programs the environment contains, we'll see that it's empty.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda list"><pre class="notranslate"><code>conda list
   </code></pre></div>
   <br>
   <p dir="auto"><strong>6.</strong> To add new packages (in this case <code>mothur</code>), we can search for them on <a href="https://anaconda.org/" rel="nofollow"><strong>Anaconda Cloud</strong></a>. Using Anaconda Cloud, we can find which channels we can retrieve <code>mothur</code> from, which versions are available, and a lot of other useful information.</p>
   <br>
   <p dir="auto">When we search for <code>mothur</code>, we can see that it's available from multiple channels but we'll use Bioconda specifically.</p>
   <p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/um-dang/conda_on_the_cluster/blob/master/images/anaconda_mothur_search_results.png"><img src="anaconda_mothur_search_results.png" alt="Image showing mothur available from multiple channels" style="max-width: 100%;"></a></p>
   <br>
   <p dir="auto"><strong>7.</strong> If we click on the Bioconda version, we'll be taken to the information page for <code>mothur</code> where we can see details about versions, metadata, and most importantly for us, installation instructions.</p>
   <p dir="auto"><a target="_blank" rel="noopener noreferrer" href="/um-dang/conda_on_the_cluster/blob/master/images/anaconda_mothur_package_page.png"><img src="anaconda_mothur_package_page.png" alt="Image of bioconda/mothur package page" style="max-width: 100%;"></a></p>
   <br>
   <p dir="auto"><strong>8.</strong> Copy the installation code for <code>mothur</code>, paste it into your terminal, and run the installation. By specifying <code>-c</code> during the install, we can tell Conda which channel to use. This is particularly important when downloading packages that have multiple copies on multiple channels.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda install -c bioconda mothur"><pre class="notranslate"><code>conda install -c bioconda mothur
   </code></pre></div>
   <p dir="auto">Even though we only told it to install <code>mothur</code>, notice that Conda automatically determines and installs the dependencies required for installing and running it. This is one of the major advantages of using a package manager like Conda as opposed to doing this manually.</p>
   <br>
   <p dir="auto"><strong>9.</strong> When the installation finishes, see what other programs/dependencies were installed.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda list"><pre class="notranslate"><code>conda list
   </code></pre></div>
   <br>
   <p dir="auto"><strong>10.</strong> Next, let's try running <code>mothur</code> to see if it worked.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="which mothur
   mothur"><pre class="notranslate"><code>which mothur
   mothur
   </code></pre></div>
   <p dir="auto"><strong>Success!</strong> We have now created a new, self-contained environment that contains everything we need to run <code>mothur</code> as part of our analysis.</p>
   <br>
   <p dir="auto">To exit <code>mothur</code>, type:</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="quit()"><pre class="notranslate"><code>quit()
   </code></pre></div>
   <br>
   <h3 dir="auto"><a id="user-content-using-yaml-files-to-create-and-share-reproducible-environments" class="anchor" aria-hidden="true" href="#using-yaml-files-to-create-and-share-reproducible-environments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Using <code>.yaml</code> Files to Create and Share Reproducible Environments</h3>
   <p dir="auto">The last important function we'll go over is the ability to <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html#creating-an-environment-from-an-environment-yml-file" rel="nofollow"><strong>create environments from a <code>.yaml</code> file</strong></a>. These files can also be shared with others so they can create similar environments. While you can programmatically export your entire environment (channels, packages, versions, etc.) to a <code>.yaml</code> file, <strong>it's generally a bad idea</strong> for a number of reasons, the main one being that they aren't typically cross-platform compatible (more information <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html?highlight=environment#building-identical-conda-environments" rel="nofollow"><strong>here</strong></a>). We'll create one manually and then show how we use it to create a new environment.</p>
   <br>
   <p dir="auto"><strong>1.</strong> To start, we'll create a <code>.yaml</code> file for our new environment. For the majority of environments, you only need to include the three essentials: <strong>i) name</strong>,  <strong>ii) channels</strong>, and <strong>iii) dependencies</strong>. Setting specific <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/concepts/pkg-specs.html#package-match-specifications" rel="nofollow">versions</a> is optional but recommended in instances where reproducibility matters. In this case, we'll be creating an environment for using <a href="http://samtools.sourceforge.net/" rel="nofollow"><strong>SAMtools</strong></a> to manipulate sequencing alignment files.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="nano testEnv.yaml"><pre class="notranslate"><code>nano testEnv.yaml
   </code></pre></div>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="name: samtools
   channels:
     - conda-forge
     - bioconda
   dependencies:
     - python=3.7.3
     - samtools=1.9"><pre class="notranslate"><code>name: samtools
   channels:
     - conda-forge
     - bioconda
   dependencies:
     - python=3.7.3
     - samtools=1.9
   </code></pre></div>
   <br>
   <p dir="auto"><strong>2.</strong> Then, we use that file to create a new environment...</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda env create -f testEnv.yaml"><pre class="notranslate"><code>conda env create -f testEnv.yaml
   </code></pre></div>
   <br>
   <p dir="auto"><strong>3.</strong> ...Which we can now use whenever we want!</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="conda env list"><pre class="notranslate"><code>conda env list
   </code></pre></div>
   <br>
   <p dir="auto"><strong>4.</strong> When looking at our updated environment list, notice that the name of the new environment is set based on the <code>name</code> attribute in the <code>.yaml</code> file and not the name of the <code>.yaml</code> file itself. It's generally good practice to name your <code>.yaml</code> file based on the <code>name</code> attribute within the file so it's easier to keep track of things. Let's finish strong and fix that.</p>
   <div class="snippet-clipboard-content notranslate position-relative overflow-auto" data-snippet-clipboard-copy-content="mv testEnv.yaml samtools.yaml"><pre class="notranslate"><code>mv testEnv.yaml samtools.yaml
   </code></pre></div>
   <br>
   <h2 dir="auto"><a id="user-content-conclusions" class="anchor" aria-hidden="true" href="#conclusions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conclusions</h2>
   <p dir="auto">Congratulations on finishing the tutorial! Now that you know the fundamentals of how to set up Conda and use it to manage environments and packages, you should be able to reliably use it as part of your analysis workflows. That being said, it's important to note the material covered as part of this tutorial only scratches the surface of what can be done with Conda and there may be occasions when you want a little more control. In those situations, I highly recommend checking out the <a href="https://docs.conda.io/en/latest/" rel="nofollow"><strong>Conda documentation</strong></a> and checking out the various user communities. They're great resources for finding new tips, debugging errors, and getting general guidance. I've also included some additional items below that might help you get to where you want to be. Good luck!</p>
   <br>
   <h3 dir="auto"><a id="user-content-best-practice-dos-and-donts-of-conda" class="anchor" aria-hidden="true" href="#best-practice-dos-and-donts-of-conda"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Best Practice DOs and DON'Ts of Conda</h3>
   <ul dir="auto">
   <li>DO verify the checksum hashes of downloaded files to make sure they downloaded properly.</li>
   <li>DO create separate environments for each task or script being ran.</li>
   <li>DON'T create Conda environments without using <code>.yaml</code> files (unless you're just testing something).</li>
   <li>DON'T export your entire environment as a <code>.yaml</code>.</li>
   <li>DO manually create <code>.yaml</code> files for each environment you plan on using.</li>
   <li>DO name your environment <code>.yaml</code> file using the same label as the <code>name</code> attribute within the file.</li>
   </ul>
   <br>
   <h3 dir="auto"><a id="user-content-additional-resources" class="anchor" aria-hidden="true" href="#additional-resources"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Additional Resources</h3>
   <ul dir="auto">
   <li>There wasn't time to cover it as part of this tutorial but one of the most useful implementations of Conda is as part of a <a href="https://snakemake.readthedocs.io/en/stable/" rel="nofollow"><strong>Snakemake</strong></a> workflow. Where Conda is a package and environment manager, Snakemake is a workflow manager. By combining the two programs, you can create entirely reproducible analysis pipelines. As point of note, the <a href="https://snakemake.readthedocs.io/en/stable/tutorial/tutorial.html" rel="nofollow"><strong>Snakemake tutorial</strong></a> is also one of the best programming tutorials I've gone through.</li>
   <li>The majority of packages on Conda are maintained by users so if you think there's a package you would like to see or maybe one that needs to be fixed, it's a great opportunity to get involved with a great group of people. I personally help maintain Bioconda and have found it really rewarding. If you're interested in contributing, you can find more information on channel specific pages (e.g. <a href="https://bioconda.github.io/contributor/index.html" rel="nofollow"><strong>Bioconda</strong></a> or <a href="https://conda-forge.org/#contribute" rel="nofollow"><strong>Conda-Forge</strong></a>) and in the <a href="https://docs.conda.io/projects/conda-build/en/latest/" rel="nofollow"><strong>Conda documentation</strong></a>.</li>
<br><hr><br>
   </ul>
   </article>

             </div>
         </div>

     </readme-toc>





    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="static/js/bootstrap.min.js"></script>
    <script src="static/js/bootstrap-dropdown.js"></script>
    <script>
      !function ($) {
        $(function(){
          // carousel demo
          $('#myCarousel').carousel()
        })
      }(window.jQuery)
    </script>
    <script>
    $(document).ready(function() {
        $('#drop1').dropdown();
    });
    </script>

  </body>
  </html>
